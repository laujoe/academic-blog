{{ $color := .Get "color" | default "#2a9d8f" }}
{{ $stars := .Get "stars" | default "0" | int }}
{{/* --- å‚æ•°è·å– --- */}}
{{ $level := .Get "level" }}      {{/* å­¦æœ¯åˆ†çº§ï¼Œå¦‚ CCF-A */}}
{{ $authors := .Get "authors" }}  {{/* ä½œè€…åˆ—è¡¨ */}}
{{ $award := .Get "award" }}      {{/* å¥–é¡¹ï¼Œå¦‚ Best Paper */}}

{{/* å…³é”®ä¿®æ”¹ 1: æ·»åŠ  w-full, max-w-full, box-border 
   è¿™èƒ½è§£å†³æ–‡å­—åœ¨é¡µé¢ä¸­é—´æ–­è¡Œçš„é—®é¢˜ 
*/}}
<div class="academic-card w-full max-w-full box-border" style="--ac-theme: {{ $color }};">
    <div class="ac-status-bar"></div>

    <div class="ac-header">
        <div class="ac-main-info">
            <div class="ac-tags">
                <span class="ac-type">{{ .Get "type" | default "Paper" }}</span>
                
                {{ with .Get "status" }}
                <span class="ac-status-badge">{{ . }}</span>
                {{ end }}

                {{/* Level æ ‡ç­¾ */}}
                {{ if $level }}
                <span class="ac-level-badge">{{ $level }}</span>
                {{ end }}

                {{/* Award å‹‹ç«  */}}
                {{ if $award }}
                <span class="ac-award-badge">ğŸ† {{ $award }}</span>
                {{ end }}
            </div>

            <h3 class="ac-title">{{ .Get "title" }}</h3>
            
            {{/* ä½œè€…åˆ—è¡¨ */}}
            {{ if $authors }}
            <div class="ac-authors">{{ $authors }}</div>
            {{ end }}
        </div>
        
        {{ if gt $stars 0 }}
        <div class="ac-stars" title="ä¸ªäººæ»¡æ„åº¦: {{ $stars }}/5">
            {{ range (seq $stars) }}
                <svg class="star-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>
            {{ end }}
        </div>
        {{ end }}
    </div>

    <div class="ac-meta-grid">
        <div class="ac-meta-item">
            <svg class="ac-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
            <span>{{ .Get "field" }}</span>
        </div>
        {{ with .Get "venue" }}
        <div class="ac-meta-item">
            <svg class="ac-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
            <span>{{ . }}</span>
        </div>
        {{ end }}
        {{ with .Get "date" }}
        <div class="ac-meta-item">
            <svg class="ac-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <span>{{ . }}</span>
        </div>
        {{ end }}
    </div>

    {{ if .Inner }}
    <div class="ac-body">
        <div class="ac-abstract-label">æ‘˜è¦ / å¤‡æ³¨</div>
        {{/* ä½¿ç”¨ prose ç±»ç¡®ä¿å†…éƒ¨ Markdown æ ¼å¼æ­£ç¡®ï¼Œä½†ç§»é™¤æœ€å¤§å®½åº¦é™åˆ¶ */}}
        <div class="ac-content prose dark:prose-invert max-w-none">
            {{ .Inner | markdownify }}
        </div>
    </div>
    {{ end }}

    {{/* --- ä»…ä¿ç•™ Link é€»è¾‘ --- */}}
    {{ $linkPath := .Get "link" }}
    
    {{ if or (.Get "pdf") $linkPath }}
    <div class="ac-footer">
        {{ with .Get "pdf" }}
        <a href="{{ . }}" target="_blank" class="ac-btn">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
            æ•°æ®åº“ è·³è½¬
        </a>
        {{ end }}

        {{ if $linkPath }}
            {{ $target := $linkPath }}
            {{ $p := $.Site.GetPage $linkPath }}
            {{ if $p }}
                {{ $target = $p.Permalink }}
            {{ end }}
            <a href="{{ $target }}" target="_blank" class="ac-btn secondary">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                Link
            </a>
        {{ end }}
    </div>
    {{ end }}
</div>

<style>
    .academic-card {
        /* â˜€ï¸ äº®è‰²æ¨¡å¼å˜é‡ */
        --ac-bg-card: #ffffff;
        --ac-bg-body: #fafafa;
        --ac-bg-footer: #ffffff;
        
        --ac-text-title: #2c3e50;
        --ac-text-authors: #666666;
        --ac-text-meta: #666666;
        --ac-text-body: #4a5568;
        --ac-text-label: #999999;
        
        --ac-border: rgba(0,0,0,0.06);
        --ac-divider: rgba(0,0,0,0.08);
        --ac-shadow: 0 4px 20px rgba(0,0,0,0.05);
        --ac-shadow-hover: 0 12px 30px rgba(0,0,0,0.08);

        --ac-badge-bg: rgba(0,0,0,0.04);
        --ac-badge-level-bg: #ffffff;
        --ac-badge-level-border: #dddddd;
        --ac-badge-level-text: #555555;
        
        --ac-btn-bg: rgba(0,0,0,0.04);
        --ac-btn-text: #555555;
        --ac-btn-hover-text: #ffffff;
        
        position: relative;
        background: var(--ac-bg-card);
        border-radius: 12px;
        box-shadow: var(--ac-shadow);
        border: 1px solid var(--ac-border);
        margin: 2.5rem 0; /* ä¿æŒå‚ç›´é—´è· */
        overflow: hidden;
        font-family: inherit;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.3s, border-color 0.3s;
        
        /* å…³é”®ä¿®æ”¹ï¼šå¼ºåˆ¶å—çº§æ˜¾ç¤ºå’Œå®½åº¦ */
        display: block;
        width: 100%;
    }

    /* ğŸŒ™ Congo æš—è‰²æ¨¡å¼é€‚é… (å…³é”®ä¿®æ”¹ 2) */
    /* Congo åœ¨ html æ ‡ç­¾ä¸ŠåŠ  class="dark" */
    html.dark .academic-card {
        --ac-bg-card: #1e293b;
        --ac-bg-body: #0f172a;
        --ac-bg-footer: #1e293b;
        
        --ac-text-title: #f1f5f9;
        --ac-text-authors: #94a3b8;
        --ac-text-meta: #94a3b8;
        --ac-text-body: #cbd5e1;
        --ac-text-label: #64748b;
        
        --ac-border: #334155;
        --ac-divider: #334155;
        --ac-shadow: 0 4px 20px rgba(0,0,0,0.3);
        --ac-shadow-hover: 0 12px 30px rgba(0,0,0,0.5);

        --ac-badge-bg: rgba(255,255,255,0.05);
        --ac-badge-level-bg: #334155;
        --ac-badge-level-border: #475569;
        --ac-badge-level-text: #cbd5e1;
        
        --ac-btn-bg: rgba(255,255,255,0.08);
        --ac-btn-text: #cbd5e1;
    }

    /* å…¼å®¹åŸæœ‰çš„åª’ä½“æŸ¥è¯¢ (å¯é€‰) */
    @media (prefers-color-scheme: dark) {
        :root:not(.light) .academic-card {
             /* è¿™é‡Œçš„å˜é‡åŒä¸Šï¼Œä¸ºäº†èŠ‚çœå­—ç¬¦çœç•¥ï¼Œä¸»è¦æ˜¯ç¡®ä¿ Congo çš„ html.dark ä¼˜å…ˆçº§æ›´é«˜ */
        }
    }

    .academic-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--ac-shadow-hover);
    }

    .ac-status-bar {
        height: 5px;
        width: 100%;
        background: var(--ac-theme);
        opacity: 0.8;
    }

    .ac-header {
        padding: 24px 28px 10px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 20px;
    }

    .ac-tags {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 12px;
        flex-wrap: wrap; 
    }

    .ac-type {
        background: var(--ac-theme);
        color: #fff;
        font-size: 13px;
        font-weight: 700;
        padding: 4px 10px;
        border-radius: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .ac-status-badge {
        font-size: 12px;
        color: var(--ac-theme);
        background: var(--ac-badge-bg);
        padding: 4px 8px;
        border-radius: 4px;
        font-weight: 600;
        transition: background 0.3s;
    }

    .ac-level-badge {
        font-size: 12px;
        color: var(--ac-badge-level-text);
        border: 1px solid var(--ac-badge-level-border);
        background: var(--ac-badge-level-bg);
        padding: 3px 8px;
        border-radius: 4px;
        font-weight: 700;
        transition: all 0.3s;
    }

    .ac-award-badge {
        font-size: 12px;
        color: #d62828;
        background: rgba(214, 40, 40, 0.08);
        padding: 3px 8px;
        border-radius: 4px;
        font-weight: 700;
        border: 1px solid rgba(214, 40, 40, 0.2);
    }

    /* Congo æš—è‰²æ¨¡å¼ä¸‹çš„ Award é¢œè‰²ä¿®å¤ */
    html.dark .ac-award-badge {
        color: #ef4444; 
        background: rgba(239, 68, 68, 0.15); 
        border-color: rgba(239, 68, 68, 0.3);
    }

    .ac-title {
        margin: 0 !important; /* å¼ºåˆ¶è¦†ç›– Markdown é»˜è®¤æ ·å¼ */
        font-size: 1.2rem;
        font-weight: 800;
        color: var(--ac-text-title);
        line-height: 1.3;
        transition: color 0.3s;
    }

    .ac-authors {
        margin-top: 8px;
        font-size: 1.1rem;
        color: var(--ac-text-authors);
        font-style: italic;
        line-height: 1.5;
        transition: color 0.3s;
    }

    .ac-stars {
        display: flex;
        gap: 2px;
        color: #f59e0b;
        flex-shrink: 0;
        margin-top: 5px;
    }
    .star-icon { width: 18px; height: 18px; }

    .ac-meta-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        padding: 10px 28px 20px;
        border-bottom: 1px dashed var(--ac-divider);
        transition: border-color 0.3s;
    }

    .ac-meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        color: var(--ac-text-meta);
        font-weight: 500;
        transition: color 0.3s;
    }

    .ac-icon { width: 16px; height: 16px; opacity: 0.6; }

    .ac-body {
        padding: 24px 28px;
        background: var(--ac-bg-body);
        transition: background 0.3s;
    }

    .ac-abstract-label {
        font-size: 14px; 
        font-weight: 700;
        color: var(--ac-text-label);
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .ac-content {
        font-size: 1.1rem;
        line-height: 1.7;
        color: var(--ac-text-body);
        transition: color 0.3s;
        /* å…³é”®ä¿®æ”¹ 3: é˜²æ­¢å†…éƒ¨æ–‡å­—æº¢å‡ºæˆ–æ–­è¡Œ */
        width: 100%;
        max-width: none; 
    }
    .ac-content p { margin-bottom: 0.8em; }
    .ac-content p:last-child { margin-bottom: 0; }

    .ac-footer {
        padding: 16px 28px;
        background: var(--ac-bg-footer);
        display: flex;
        gap: 12px;
        border-top: 1px solid var(--ac-border);
        transition: background 0.3s, border-color 0.3s;
    }

    .ac-btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: 600;
        text-decoration: none;
        padding: 8px 16px;
        border-radius: 6px;
        transition: all 0.2s;
        background: var(--ac-btn-bg);
        color: var(--ac-btn-text);
        line-height: 1.2; /* é˜²æ­¢æŒ‰é’®å†…æ–‡å­—é”™ä½ */
    }

    .ac-btn:hover {
        background: var(--ac-theme);
        color: var(--ac-btn-hover-text);
        transform: translateY(-1px);
        text-decoration: none !important;
    }

    .ac-btn.secondary { 
        background: transparent; 
        border: 1px solid rgba(128,128,128, 0.2); 
    }
    
    .ac-btn.secondary:hover { 
        border-color: var(--ac-theme); 
        color: var(--ac-theme); 
        background: transparent; 
    }
    
    @media (max-width: 600px) {
        .ac-header { flex-direction: column; gap: 10px; padding: 20px 20px 10px; }
        .ac-stars { margin-top: 0; }
        .ac-meta-grid { flex-direction: column; gap: 10px; padding: 10px 20px 20px; }
        .ac-body { padding: 20px; }
        .ac-footer { flex-wrap: wrap; padding: 16px 20px; }
    }
</style>